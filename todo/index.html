<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìù Minha Lista de Tarefas</title>
    <meta name="description" content="Um app simples de lista de tarefas que funciona offline">
    <meta name="theme-color" content="#667eea">
    
    <!-- PWA manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Todo List">
    
    <!-- Favicon as SVG -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmczMiIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWEiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNzY0YmEyIi8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHJ4PSI0IiByeT0iNCIgZmlsbD0idXJsKCNiZzMyKSIvPgogIDxnIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBmaWxsPSJub25lIj4KICAgIDxsaW5lIHgxPSIxMCIgeTE9IjEwIiB4Mj0iMjYiIHkyPSIxMCIvPgogICAgPGxpbmUgeDE9IjEwIiB5MT0iMTYiIHgyPSIyNiIgeTI9IjE2Ii8+CiAgICA8bGluZSB4MT0iMTAiIHkxPSIyMiIgeDI9IjI2IiB5Mj0iMjIiLz4KICAgIDxwYXRoIGQ9Ik00IDEwIEw2IDEyIEwxMCA4Ii8+CiAgPC9nPgogIDxjaXJjbGUgY3g9IjYiIGN5PSIxNiIgcj0iMSIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgogIDxjaXJjbGUgY3g9IjYiIGN5PSIyMiIgcj0iMSIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgo8L3N2Zz4=">
    
    <style>
        :root {
            --primary-color: #667eea;
            --primary-dark: #5a6fd8;
            --secondary-color: #764ba2;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --bg-card: #ffffff;
            --bg-secondary: #f8fafc;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --text-light: #9ca3af;
            --border-color: #e5e7eb;
            --border-radius: 12px;
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --transition: all 0.2s ease-in-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .main {
            flex: 1;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            margin-bottom: 1rem;
        }

        .input-group {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        #taskInput {
            flex: 1;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: var(--bg-secondary);
        }

        #taskInput:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        #addBtn {
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            min-width: 60px;
        }

        #addBtn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .tasks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .tasks-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .task-count {
            background: var(--bg-secondary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: var(--bg-secondary);
            padding: 0.25rem;
            border-radius: var(--border-radius);
        }

        .filter-btn {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 500;
            border-radius: calc(var(--border-radius) - 0.25rem);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .task-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .task-item {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1rem 1.25rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
            border: 2px solid transparent;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .task-item:hover {
            background: var(--bg-card);
            border-color: var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .task-item.completed {
            opacity: 0.7;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .task-checkbox:hover {
            border-color: var(--success-color);
        }

        .task-checkbox.checked {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .task-checkbox.checked::after {
            content: '‚úì';
            font-size: 12px;
            font-weight: bold;
        }

        .task-text {
            flex: 1;
            font-size: 1rem;
            transition: var(--transition);
        }

        .task-text.completed {
            text-decoration: line-through;
            color: var(--text-light);
        }

        .task-date {
            font-size: 0.75rem;
            color: var(--text-light);
            font-weight: 400;
        }

        .delete-btn {
            background: var(--danger-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .delete-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .empty-state.hidden {
            display: none;
        }

        .footer {
            text-align: center;
            color: white;
            opacity: 0.8;
            font-size: 0.875rem;
        }

        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            max-width: 400px;
            margin: 0 auto;
            border: 2px solid var(--primary-color);
        }

        .install-prompt.hidden {
            display: none;
        }

        .install-content h3 {
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .install-content p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .install-buttons {
            display: flex;
            gap: 0.75rem;
        }

        .install-buttons button {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        #installBtn {
            background: var(--primary-color);
            color: white;
        }

        #installBtn:hover {
            background: var(--primary-dark);
        }

        #dismissBtn {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        #dismissBtn:hover {
            background: var(--border-color);
        }

        @media (max-width: 480px) {
            .container { padding: 15px; }
            .header h1 { font-size: 2rem; }
            .main { padding: 1.5rem; }
            .input-group { flex-direction: column; }
            #addBtn { align-self: stretch; }
            .tasks-header { flex-direction: column; gap: 1rem; text-align: center; }
            .filter-tabs { flex-direction: column; }
            .task-item { padding: 1rem; }
            .install-prompt { left: 10px; right: 10px; bottom: 10px; }
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-card: #374151;
                --bg-secondary: #1f2937;
                --text-primary: #f9fafb;
                --text-secondary: #d1d5db;
                --text-light: #9ca3af;
                --border-color: #4b5563;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üìù Minha Lista de Tarefas</h1>
            <p>Organize suas tarefas de forma simples e eficiente</p>
        </header>

        <main class="main">
            <div class="input-group">
                <input 
                    type="text" 
                    id="taskInput" 
                    placeholder="Adicione uma nova tarefa..."
                    maxlength="100"
                >
                <button id="addBtn" type="button">+</button>
            </div>

            <div class="tasks-header">
                <h2>Suas Tarefas</h2>
                <div class="task-count">
                    <span id="taskCount">0 tarefas</span>
                </div>
            </div>

            <div class="filter-tabs">
                <button class="filter-btn active" data-filter="all">Todas</button>
                <button class="filter-btn" data-filter="pending">Pendentes</button>
                <button class="filter-btn" data-filter="completed">Conclu√≠das</button>
            </div>

            <ul id="taskList" class="task-list"></ul>

            <div id="emptyState" class="empty-state">
                <div class="empty-icon">üìã</div>
                <h3>Nenhuma tarefa ainda</h3>
                <p>Adicione sua primeira tarefa para come√ßar!</p>
            </div>
        </main>

        <footer class="footer">
            <p>üí° Este app funciona offline e salva suas tarefas localmente</p>
        </footer>
    </div>

    <div id="installPrompt" class="install-prompt hidden">
        <div class="install-content">
            <h3>üì± Instalar App</h3>
            <p>Instale este app no seu dispositivo para acesso r√°pido!</p>
            <div class="install-buttons">
                <button id="installBtn">Instalar</button>
                <button id="dismissBtn">Agora n√£o</button>
            </div>
        </div>
    </div>

    <script>
        class TodoApp {
            constructor() {
                this.tasks = JSON.parse(localStorage.getItem('todoTasks') || '[]');
                this.currentFilter = 'all';
                this.installPrompt = null;
                
                this.initializeElements();
                this.bindEvents();
                this.renderTasks();
                this.updateTaskCount();
                this.setupInstallPrompt();
            }

            initializeElements() {
                this.taskInput = document.getElementById('taskInput');
                this.addBtn = document.getElementById('addBtn');
                this.taskList = document.getElementById('taskList');
                this.taskCount = document.getElementById('taskCount');
                this.emptyState = document.getElementById('emptyState');
                this.filterBtns = document.querySelectorAll('.filter-btn');
                this.installPromptEl = document.getElementById('installPrompt');
                this.installBtn = document.getElementById('installBtn');
                this.dismissBtn = document.getElementById('dismissBtn');
            }

            bindEvents() {
                this.addBtn.addEventListener('click', () => this.addTask());
                this.taskInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addTask();
                });

                this.filterBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.setFilter(e.target.dataset.filter);
                    });
                });

                this.installBtn?.addEventListener('click', () => this.installApp());
                this.dismissBtn?.addEventListener('click', () => this.dismissInstall());
            }

            addTask() {
                const text = this.taskInput.value.trim();
                if (!text) return;

                const task = {
                    id: Date.now().toString(),
                    text: text,
                    completed: false,
                    createdAt: new Date().toISOString()
                };

                this.tasks.unshift(task);
                this.saveTasks();
                this.renderTasks();
                this.updateTaskCount();
                this.taskInput.value = '';
                this.taskInput.focus();
                this.showFeedback('Tarefa adicionada!', 'success');
            }

            toggleTask(taskId) {
                const task = this.tasks.find(t => t.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    task.updatedAt = new Date().toISOString();
                    this.saveTasks();
                    this.renderTasks();
                    this.updateTaskCount();

                    const message = task.completed ? 'Tarefa conclu√≠da!' : 'Tarefa reaberta!';
                    this.showFeedback(message, task.completed ? 'success' : 'info');
                }
            }

            deleteTask(taskId) {
                if (confirm('Tem certeza que deseja excluir esta tarefa?')) {
                    this.tasks = this.tasks.filter(t => t.id !== taskId);
                    this.saveTasks();
                    this.renderTasks();
                    this.updateTaskCount();
                    this.showFeedback('Tarefa exclu√≠da!', 'warning');
                }
            }

            setFilter(filter) {
                this.currentFilter = filter;
                this.filterBtns.forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.filter === filter);
                });
                this.renderTasks();
            }

            getFilteredTasks() {
                switch (this.currentFilter) {
                    case 'pending':
                        return this.tasks.filter(task => !task.completed);
                    case 'completed':
                        return this.tasks.filter(task => task.completed);
                    default:
                        return this.tasks;
                }
            }

            renderTasks() {
                const filteredTasks = this.getFilteredTasks();
                
                if (filteredTasks.length === 0) {
                    this.taskList.style.display = 'none';
                    this.emptyState.classList.remove('hidden');
                    
                    const emptyMessages = {
                        all: 'Nenhuma tarefa ainda',
                        pending: 'Nenhuma tarefa pendente',
                        completed: 'Nenhuma tarefa conclu√≠da'
                    };
                    
                    this.emptyState.querySelector('h3').textContent = emptyMessages[this.currentFilter];
                } else {
                    this.taskList.style.display = 'flex';
                    this.emptyState.classList.add('hidden');
                }

                this.taskList.innerHTML = filteredTasks.map(task => this.createTaskHTML(task)).join('');
                this.bindTaskEvents();
            }

            createTaskHTML(task) {
                const date = new Date(task.createdAt).toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });

                return `
                    <li class="task-item ${task.completed ? 'completed' : ''}" data-task-id="${task.id}">
                        <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-task-id="${task.id}"></div>
                        <div class="task-text ${task.completed ? 'completed' : ''}">${this.escapeHtml(task.text)}</div>
                        <div class="task-date">${date}</div>
                        <button class="delete-btn" data-task-id="${task.id}" title="Excluir tarefa">üóëÔ∏è</button>
                    </li>
                `;
            }

            bindTaskEvents() {
                document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('click', (e) => {
                        this.toggleTask(e.target.dataset.taskId);
                    });
                });

                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.deleteTask(e.target.dataset.taskId);
                    });
                });
            }

            updateTaskCount() {
                const totalTasks = this.tasks.length;
                const completedTasks = this.tasks.filter(task => task.completed).length;
                const pendingTasks = totalTasks - completedTasks;

                let countText = '';
                switch (this.currentFilter) {
                    case 'pending':
                        countText = `${pendingTasks} pendente${pendingTasks !== 1 ? 's' : ''}`;
                        break;
                    case 'completed':
                        countText = `${completedTasks} conclu√≠da${completedTasks !== 1 ? 's' : ''}`;
                        break;
                    default:
                        countText = `${totalTasks} tarefa${totalTasks !== 1 ? 's' : ''}`;
                        break;
                }

                this.taskCount.textContent = countText;
            }

            saveTasks() {
                localStorage.setItem('todoTasks', JSON.stringify(this.tasks));
            }

            escapeHtml(text) {
                const map = {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#039;'
                };
                return text.replace(/[&<>"']/g, m => map[m]);
            }

            showFeedback(message, type = 'info') {
                const feedback = document.createElement('div');
                feedback.textContent = message;
                
                Object.assign(feedback.style, {
                    position: 'fixed',
                    top: '20px',
                    right: '20px',
                    padding: '12px 20px',
                    borderRadius: '8px',
                    color: 'white',
                    fontWeight: '500',
                    fontSize: '14px',
                    zIndex: '1001',
                    opacity: '0',
                    transform: 'translateY(-20px)',
                    transition: 'all 0.3s ease'
                });

                const colors = {
                    success: '#10b981',
                    warning: '#f59e0b',
                    error: '#ef4444',
                    info: '#3b82f6'
                };
                feedback.style.backgroundColor = colors[type] || colors.info;

                document.body.appendChild(feedback);

                requestAnimationFrame(() => {
                    feedback.style.opacity = '1';
                    feedback.style.transform = 'translateY(0)';
                });

                setTimeout(() => {
                    feedback.style.opacity = '0';
                    feedback.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        if (feedback.parentNode) {
                            feedback.parentNode.removeChild(feedback);
                        }
                    }, 300);
                }, 3000);
            }

            setupInstallPrompt() {
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    this.installPrompt = e;
                    
                    setTimeout(() => {
                        if (!this.isInstalled()) {
                            this.showInstallPrompt();
                        }
                    }, 5000);
                });

                window.addEventListener('appinstalled', () => {
                    this.hideInstallPrompt();
                    this.showFeedback('App instalado com sucesso!', 'success');
                });

                if (this.isIOSDevice() && !this.isInstalled()) {
                    setTimeout(() => {
                        this.showIOSInstallPrompt();
                    }, 5000);
                }
            }

            isInstalled() {
                return window.matchMedia('(display-mode: standalone)').matches ||
                       window.navigator.standalone === true;
            }

            isIOSDevice() {
                return /iPad|iPhone|iPod/.test(navigator.userAgent);
            }

            showInstallPrompt() {
                this.installPromptEl?.classList.remove('hidden');
            }

            hideInstallPrompt() {
                this.installPromptEl?.classList.add('hidden');
            }

            installApp() {
                if (this.installPrompt) {
                    this.installPrompt.prompt();
                    this.installPrompt.userChoice.then((choiceResult) => {
                        this.installPrompt = null;
                        this.hideInstallPrompt();
                    });
                }
            }

            dismissInstall() {
                this.hideInstallPrompt();
                localStorage.setItem('installPromptDismissed', Date.now().toString());
            }

            showIOSInstallPrompt() {
                if (localStorage.getItem('iosInstallPromptDismissed')) return;

                const prompt = document.createElement('div');
                prompt.className = 'install-prompt';
                prompt.innerHTML = `
                    <div class="install-content">
                        <h3>üì± Instalar no iOS</h3>
                        <p>Para instalar: toque no bot√£o de compartilhar ‚ÜóÔ∏è e selecione "Adicionar √† Tela de In√≠cio"</p>
                        <div class="install-buttons">
                            <button onclick="this.parentElement.parentElement.parentElement.remove(); localStorage.setItem('iosInstallPromptDismissed', Date.now());">Entendi</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(prompt);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new TodoApp();
        });

        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                document.getElementById('taskInput').focus();
            }
            
            if (e.key === 'Escape') {
                document.getElementById('taskInput').value = '';
                document.getElementById('taskInput').blur();
            }
        });

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
